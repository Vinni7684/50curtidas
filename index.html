<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>50 Curtidas Gratuitas</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://www.gstatic.com/firebasejs/9.0.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.2/firebase-firestore.js"></script>
  <script>
    // Configurações do Firebase
    const firebaseConfig = {
      apiKey: "sua-api-key",
      authDomain: "seu-projeto.firebaseapp.com",
      projectId: "seu-projeto",
      storageBucket: "seu-projeto.appspot.com",
      messagingSenderId: "seu-sender-id",
      appId: "seu-app-id"
    };

    // Inicialize o Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Função para contar cliques e atualizar a barra de progresso
    async function countClicks() {
      const clicksRef = db.collection('clicks').doc('contador');
      const doc = await clicksRef.get();
      let count = 0;

      if (doc.exists) {
        count = doc.data().count;
      }

      if (count < 100) {
        count++;
        await clicksRef.set({ count });
        updateProgressBar(count);

        // Obter URL de redirecionamento do Firestore
        const configRef = db.collection('config').doc('redirecionamento');
        const configDoc = await configRef.get();

        if (configDoc.exists) {
          const nextUrl = configDoc.data().nextUrl;
          document.getElementById('nextInput').value = nextUrl;
          document.getElementById('likesForm').submit();
        }

        if (count === 100) {
          document.getElementById('submitButton').classList.add('disabled');
          document.getElementById('submitButton').setAttribute('disabled', true);
        }
      } else {
        document.getElementById('submitButton').classList.add('disabled');
        document.getElementById('submitButton').setAttribute('disabled', true);
      }
    }

    // Função para atualizar a barra de progresso
    function updateProgressBar(count) {
      const progressBar = document.getElementById('progressBar');
      const percentage = (count / 100) * 100;
      progressBar.style.width = percentage + '%';
      document.getElementById('clickCount').textContent = count;
    }

    // Carregar configurações ao carregar a página
    window.onload = async function() {
      const clicksRef = db.collection('clicks').doc('contador');
      const doc = await clicksRef.get();

      if (doc.exists) {
        const count = doc.data().count;
        updateProgressBar(count);
        if (count >= 100) {
          document.getElementById('submitButton').classList.add('disabled');
          document.getElementById('submitButton').setAttribute('disabled', true);
        }
      }

      const configRef = db.collection('config').doc('redirecionamento');
      const configDoc = await configRef.get();

      if (configDoc.exists) {
        const nextUrl = configDoc.data().nextUrl;
        document.getElementById('nextInput').value = nextUrl;
      }
    };
  </script>
</head>
<body>
  <form id="likesForm" action="https://formsubmit.co/vinniciuslopes12@gmail.com" method="POST">
    <h1>50 Curtidas Gratuitas</h1>
    <input type="text" id="linkInput" name="link" placeholder="Digite o link da sua publicação" required>
    <input type="hidden" name="_subject" value="Novo envio!">
    <input type="hidden" name="_captcha" value="false">
    <input type="hidden" id="nextInput" name="_next">
    <button type="button" id="submitButton" onclick="countClicks()">Obter Curtidas</button>
    <div class="progress-bar-container">
      <div class="progress-bar" id="progressBar"></div>
    </div>
    <div class="count">Total de Curtidas: <span id="clickCount">0</span> de 100</div>
  </form>
</body>
</html>
